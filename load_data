Recent packages of Neo4j for Windows do not include neo4j-shell. The Neo4j browser will only accept one statement at a time, making scripts consisting of multiple Cypher commands a problem.

CREATE CONSTRAINT ON (game:Game) ASSERT game.gameId IS UNIQUE
CREATE CONSTRAINT ON (eco:ECO) ASSERT eco.code IS UNIQUE
CREATE CONSTRAINT ON (tournament:Tournament) ASSERT tournament.name IS UNIQUE
CREATE CONSTRAINT ON (player:Player) ASSERT player.name IS UNIQUE

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MERGE (game:Game { gameId: row.GameNumber })
ON CREATE SET game.gameId = row.GameNumber,game.date=row.Date,game.result=row.Result,game.whiteElo=row.WhiteElo,game.blackElo=row.BlackElo,game.halfMoves=row.HalfMoves,game.moves=row.Moves

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MERGE (eco:Eco { code: row.ECO })
ON CREATE SET eco.code = row.ECO,eco.name=row.Opening

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MERGE (tournament:Tournament { name: row.Event })
ON CREATE SET tournament.name = row.Event,tournament.site = row.Site,tournament.date = row.EventDate

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MERGE (player:Player { name: row.White })
ON CREATE SET player.name = row.White

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MERGE (player:Player { name: row.Black })
ON CREATE SET player.name = row.Black

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MATCH (eco:ECO { code: row.ECO }),(game:Game { gameId: row.GameNumber})
MERGE (eco)-[r:Opening]->(game)

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MATCH (eco { code: row.ECO }), (game { gameId: row.GameNumber })
MERGE (eco)-[r:Opening]->(game)
RETURN eco.name, type(r), game.gameId

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MATCH (tournament { name: row.Event }), (game { gameId: row.GameNumber })
MERGE (tournament)-[r:Include  { round: row.Round}]->(game)
RETURN tournament.name, type(r), game.gameId

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MATCH (player { name: row.White }), (game { gameId: row.GameNumber })
MERGE (player)-[r:Plays  { Color: 'White'}]->(game)
RETURN player.name, type(r), game.gameId

LOAD CSV WITH HEADERS FROM "file:///data_chess.csv" AS row
MATCH (player { name: row.Black }), (game { gameId: row.GameNumber })
MERGE (player)-[r:Plays  { Color: 'Black'}]->(game)
RETURN player.name, type(r), game.gameId